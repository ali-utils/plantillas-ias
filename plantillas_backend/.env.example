# ========================================
# Environment Variables - bMOI Backend API
# ========================================
# Copy this file to .env and fill in the values
# NEVER commit .env to git!
# ========================================

# ========================================
# Application
# ========================================
NODE_ENV=development
PORT=3000
API_PREFIX=api/v1
APP_NAME=bMOI Backend API
APP_VERSION=1.0.0

# ========================================
# Database (PostgreSQL)
# ========================================
DATABASE_URL=postgresql://bmoi:bmoi_password_dev@localhost:5432/bmoi_db?schema=public
POSTGRES_USER=bmoi
POSTGRES_PASSWORD=bmoi_password_dev
POSTGRES_DB=bmoi_db
POSTGRES_PORT=5432
POSTGRES_HOST=localhost

# Database Connection Pool
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=20

# ========================================
# JWT Authentication
# ========================================
# Generate with: openssl genrsa -out private.pem 2048
# Extract public: openssl rsa -in private.pem -pubout -out public.pem
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production-min-32-chars
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d
JWT_ALGORITHM=RS256

# For RS256 (recommended for production):
# JWT_PRIVATE_KEY_PATH=./keys/private.pem
# JWT_PUBLIC_KEY_PATH=./keys/public.pem

# ========================================
# Redis
# ========================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=redis_password_dev
REDIS_DB=0
REDIS_TTL_DEFAULT=300

# Redis Connection Pool
REDIS_MAX_RETRY=3
REDIS_RETRY_DELAY=100

# ========================================
# MinIO (S3-compatible Storage)
# ========================================
MINIO_ENDPOINT=localhost
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123
MINIO_USE_SSL=false
MINIO_BUCKET_NAME=bmoi-files
MINIO_REGION=us-east-1

# For AWS S3 in production:
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=bmoi-files-prod

# ========================================
# CORS
# ========================================
CORS_ORIGIN=http://localhost:5173,http://localhost:3001,http://localhost:4200
CORS_CREDENTIALS=true

# ========================================
# Rate Limiting
# ========================================
RATE_LIMIT_TTL=60
RATE_LIMIT_LIMIT=100

# Per-endpoint limits (optional)
RATE_LIMIT_AUTH_TTL=60
RATE_LIMIT_AUTH_LIMIT=5

# ========================================
# Logging
# ========================================
LOG_LEVEL=debug
LOG_FORMAT=json
LOG_FILE_PATH=./logs
LOG_MAX_FILES=7d
LOG_MAX_SIZE=10m

# ========================================
# Security
# ========================================
BCRYPT_ROUNDS=10

# Helmet Configuration
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true

# ========================================
# Email (SMTP) - Optional
# ========================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@bmoi.com
SMTP_FROM_NAME=bMOI Platform

# SendGrid alternative:
# SENDGRID_API_KEY=

# ========================================
# Queue (BullMQ)
# ========================================
QUEUE_REDIS_HOST=localhost
QUEUE_REDIS_PORT=6379
QUEUE_REDIS_PASSWORD=redis_password_dev

# ========================================
# Monitoring & Observability
# ========================================

# Sentry (Error Tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus Metrics
METRICS_ENABLED=true
METRICS_PORT=9090

# APM (Application Performance Monitoring)
APM_ENABLED=false
APM_SERVER_URL=
APM_SECRET_TOKEN=

# ========================================
# Feature Flags
# ========================================
FEATURE_FLAG_EMAIL_VERIFICATION=true
FEATURE_FLAG_TWO_FACTOR_AUTH=false
FEATURE_FLAG_EXPORT_USERS=true
FEATURE_FLAG_AUDIT_LOGS=true

# ========================================
# Plan Limits
# ========================================
PLAN_FREE_USERS=10
PLAN_FREE_PRODUCTS=50
PLAN_FREE_STORAGE_GB=1

PLAN1_USERS=50
PLAN1_PRODUCTS=500
PLAN1_STORAGE_GB=10

PLAN2_USERS=200
PLAN2_PRODUCTS=2000
PLAN2_STORAGE_GB=50

PLAN3_USERS=-1
PLAN3_PRODUCTS=-1
PLAN3_STORAGE_GB=500

# ========================================
# Webhooks (Optional)
# ========================================
WEBHOOK_SECRET=webhook-secret-change-in-production
WEBHOOK_TIMEOUT=5000

# ========================================
# Third-Party Integrations (Optional)
# ========================================

# Stripe (Payments)
STRIPE_PUBLIC_KEY=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# Google OAuth
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_CALLBACK_URL=http://localhost:3000/api/v1/auth/google/callback

# Microsoft OAuth
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=
MICROSOFT_CALLBACK_URL=http://localhost:3000/api/v1/auth/microsoft/callback

# ========================================
# Development Tools
# ========================================

# Prisma Studio
PRISMA_STUDIO_PORT=5555

# Debug Mode
DEBUG=false

# Swagger/OpenAPI Docs
SWAGGER_ENABLED=true
SWAGGER_PATH=api/docs
SWAGGER_TITLE=bMOI Backend API
SWAGGER_DESCRIPTION=Multi-tenant backend API for bMOI platform
SWAGGER_VERSION=1.0.0

# ========================================
# Testing
# ========================================
TEST_DATABASE_URL=postgresql://bmoi:bmoi_password_dev@localhost:5432/bmoi_test?schema=public
TEST_REDIS_HOST=localhost
TEST_REDIS_PORT=6379

# ========================================
# Production Overrides
# ========================================
# In production, override these via environment variables
# or secret management service (AWS Secrets Manager, Vault, etc.)

# Production DB (example)
# DATABASE_URL=postgresql://user:pass@prod-db.example.com:5432/bmoi_prod?ssl=true

# Production Redis (example)
# REDIS_HOST=prod-redis.example.com
# REDIS_PORT=6379
# REDIS_PASSWORD=<strong-password>

# Production MinIO/S3 (example)
# AWS_ACCESS_KEY_ID=<access-key>
# AWS_SECRET_ACCESS_KEY=<secret-key>
# AWS_S3_BUCKET=bmoi-files-prod

# ========================================
# Health Checks
# ========================================
HEALTH_CHECK_DATABASE=true
HEALTH_CHECK_REDIS=true
HEALTH_CHECK_MINIO=true

# ========================================
# Notes
# ========================================
# - Use strong, random passwords in production
# - Never commit .env to version control
# - Use secret management service in production
# - Rotate secrets regularly
# - Follow principle of least privilege
# - Enable 2FA for critical services
